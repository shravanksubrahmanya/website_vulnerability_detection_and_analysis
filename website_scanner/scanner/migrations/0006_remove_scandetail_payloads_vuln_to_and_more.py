# Generated by Django 4.1 on 2023-07-11 18:41

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('scanner', '0005_scandetail'),
    ]

    operations = [
        migrations.RemoveField(
            model_name='scandetail',
            name='payloads_vuln_to',
        ),
        migrations.RemoveField(
            model_name='scandetail',
            name='response',
        ),
        migrations.CreateModel(
            name='ScannedURLDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('vuln_cat_id', models.IntegerField(blank=True, choices=[(1, 'SQL Injection (SQLi)'), (2, 'Cross Site Scripting (XSS)'), (3, 'Remote Code Execution (RCE)'), (4, 'File Inclusion (FI)'), (5, 'Sensitive Data Exposure (SDE)'), (6, 'Insecure Direct Object  References (IDOR)'), (7, 'Security misconfigurations (SM)')])),
                ('payload', models.CharField(max_length=2000)),
                ('code_snippet', models.TextField()),
                ('bug', models.TextField()),
                ('url_id', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='scanner.scandetail')),
            ],
            options={
                'verbose_name': 'ScannedURLDetail',
                'verbose_name_plural': 'ScannedURLDetails',
            },
        ),
    ]
