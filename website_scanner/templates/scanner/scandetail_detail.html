{% extends 'base.html' %}
{% load bootstrap4 %}
{% load static %}

{% block content %}
<h1 class="posttitle loader"> Scan Information</h1>
<p class="postcontent"> Scenned URL: <strong> {{scandetail.url}} </strong></p>
<p class="postcontent"> Last Scan: {{scandetail.scan_time|date:"F j, Y H:i:s" }} </p>
<hr style="border: none; border-top: 3px solid #000;">
<div>
    {% comment %} <table class="table table-hover">
        <thead>
            <th>Sl No.</th>
            <th>Payload</th>
            <th>Code Snippet</th>
            <th>Bug</th>
        </thead>
        <tbody>
            {% for type in vuln_type %}
            <tr>
                <td colspan="3"><h3>{{type}}</h3></td>
            </tr>
                {% for scanned_urldetail in scanned_urldetails %}
                <tr>
                    {% if scanned_urldetail.vuln_cat_id == type %}
                        <td>{{ scanned_urldetail.payload }}</td>
                        <td>{{ scanned_urldetail.code_snippet }}</td>
                        <td>{{ scanned_urldetail.bug }}</td>
                    {% endif %}
                </tr>
                {% endfor %}   
            {% endfor %}
        </tbody>
    </table> {% endcomment %}
{% comment %} 
    {% for type in vuln_type %}
    {% if type == 1 %}
        <h3>SQL Injection </h3>
    {% elif type == 2 %}
        <h3> Cross Site Scripting</h3>
    {% elif type == 3 %}
        <h3>Remote Code Execution</h3>
    {% endif %}
                {% for scanned_urldetail in scanned_urldetails %}
                    {% if scanned_urldetail.vuln_cat_id == type %}
                        <p>{{ scanned_urldetail.payload }}</p>
                        <p>{{ scanned_urldetail.code_snippet }}</p>
                        <p>{{ scanned_urldetail.bug }}</p>
                    {% endif %}
                {% endfor %}   
            {% endfor %} {% endcomment %}
</div>
<hr style="border: none; border-top: 3px solid #000;">
<div>
    <h3> Possible Solution</h3>
    <p class="postcontent"> {{scandetail.solution_response|safe|linebreaksbr}} </p>
</div>
{% endblock content %}