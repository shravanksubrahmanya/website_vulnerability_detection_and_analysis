{% extends 'base.html' %}
{% load bootstrap4 %}
{% load static %}

{% block content %}
<div class="centerstage container"> 
    <h1 class="techfont">Scan Details</h1>
        <div class="describe_font"> 
            <table class="table table-bordered datatable table-striped table-hover table-active">
                <thead> 
                    <tr>
                        <th>Sl. No.</th>
                        <th>Target</th>
                        <th>Scan Type</th>
                        <th>Last Scan </th>
                        <th>Vulnerable to</th>
                        <th>Status</th>
                        <th>View Details</th>
                    </tr>
                </thead>
                <tbody>
                    {% for scan_detail in scandetail_list %}
                    <tr>
                        <td> {{ scan_detail.url }} </td>
                        <td> {{ scan_detail.scan_type }} </td>
                        <td> {{ scan_detail.scan_time|date:"F j, Y H:i:s" }} </td>
                        <td> 
                            {% if scan_detail.vuln_cats is not None %}
                                <ul class="list-inline">
                                    {% for index in scan_detail.vuln_cats %}
                                    {% if index == '1' %}
                                        <li class="list-inline-item">SQL Injection</li>
                                    {% elif index == '2'%}
                                        <li class="list-inline-item">Cross Site Scripting</li>
                                    {% elif index == '3'%}
                                        <li class="list-inline-item">Remote Code Execution</li>
                                    {% endif %}
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <p>No vulnerabilities<p>
                            {% endif %}
                            </td>
                        <td> 
                            {% if scan_detail.status == 1 %}
                                <span class="glyphicon glyphicon-ok text-success"> Secure </span>
                            {% else %}
                                <span class="glyphicon glyphicon-remove text-danger"> Vulnerable </span>
                            {% endif %}
                        </td>
                        {% if scan_detail.status == 1 %}
                        <td><a class="btn btn-primary disabled"><span class="glyphicon glyphicon-eye-open"> </span></a></td>
                        {% else %}
                        <td><a class="btn btn-primary" href="{% url 'scanner:scandetail_detail' pk=scan_detail.pk %}"><span class="glyphicon glyphicon-eye-open"> </span></a></td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    
</div>
{% endblock content %}